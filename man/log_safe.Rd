% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stability.R
\name{log_safe}
\alias{log_safe}
\title{Safe logarithm (handles zeros)}
\usage{
log_safe(x, eps = .Machine$double.eps)
}
\arguments{
\item{x}{A value object or numeric}

\item{eps}{Minimum value to clamp x to (default: .Machine$double.eps)}
}
\value{
log(max(x, eps))
}
\description{
Computes log(x) with protection against log(0) = -Inf.
Optionally clamps input to a minimum value.
}
\details{
This is useful when computing log-likelihoods where probabilities
might numerically become zero. The gradient is computed as if
the clamping didn't happen (straight-through estimator) when x > eps.
}
